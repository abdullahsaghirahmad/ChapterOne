{"ast":null,"code":"var _jsxFileName = \"/Users/Projects/ChapterOne/src/components/features/BooksPage.tsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport { BookCard } from './BookCard';\nimport { SearchBar } from './SearchBar';\nimport { api } from '../../services/api';\nimport { Switch } from '../ui/Switch';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const BooksPage = () => {\n  _s();\n  const [books, setBooks] = useState([]);\n  const [error, setError] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [includeExternal, setIncludeExternal] = useState(true);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [searchType, setSearchType] = useState('all');\n  const fetchBooks = async (query = '', type = 'all', useExternal = includeExternal) => {\n    setLoading(true);\n    setError(null);\n    try {\n      let data;\n      if (query) {\n        data = await api.searchBooks(query, type, useExternal);\n      } else {\n        data = await api.getBooks(useExternal);\n      }\n\n      // Helper function to extract value from object or return the value itself\n      const getValue = item => {\n        if (typeof item === 'object' && item !== null && 'value' in item) {\n          return item.value;\n        }\n        return item;\n      };\n\n      // Process the books to handle all fields that might be objects\n      const processedData = data.map(book => ({\n        ...book,\n        pace: getValue(book.pace) || \"Moderate\",\n        tone: Array.isArray(book.tone) ? book.tone.map(t => getValue(t)) : [],\n        themes: Array.isArray(book.themes) ? book.themes.map(t => getValue(t)) : []\n      }));\n      console.log('Processed books:', processedData);\n      setBooks(processedData);\n    } catch (err) {\n      console.error('Error processing books:', err);\n      setError(err instanceof Error ? err.message : 'Failed to load data. Please try again later.');\n    } finally {\n      setLoading(false);\n    }\n  };\n  useEffect(() => {\n    fetchBooks(searchQuery, searchType, includeExternal);\n  }, [includeExternal]); // Re-fetch when external toggle changes\n\n  const handleSearch = (query, type) => {\n    setSearchQuery(query);\n    if (type) {\n      setSearchType(type);\n    }\n    fetchBooks(query, type || searchType);\n  };\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-center py-10\",\n      children: \"Loading books...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 12\n    }, this);\n  }\n  if (error) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-center py-10 text-red-600\",\n      children: [\"Error: \", error]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 12\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"space-y-8\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-center space-y-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"text-3xl font-bold text-primary-900\",\n        children: \"Book Recommendations\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-lg text-primary-600\",\n        children: \"Discover books that match your interests and reading style\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"max-w-3xl mx-auto\",\n      children: [/*#__PURE__*/_jsxDEV(SearchBar, {\n        onSearch: handleSearch,\n        onMoodSelect: mood => handleSearch(mood, 'mood')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center justify-end mt-4 space-x-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-sm text-gray-600\",\n          children: \"Include more books from external sources\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Switch, {\n          checked: includeExternal,\n          onChange: () => setIncludeExternal(prev => !prev),\n          className: \"data-[state=checked]:bg-green-500\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 7\n    }, this), books.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-center py-10\",\n      children: \"No books found. Try a different search or enable external sources.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-4 text-sm text-gray-600\",\n        children: [\"Found \", books.length, \" books \", searchQuery ? `for \"${searchQuery}\"` : '', searchType !== 'all' && ` by ${searchType}`]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid gap-6 grid-cols-1 lg:grid-cols-2\",\n        children: books.map(book => /*#__PURE__*/_jsxDEV(BookCard, {\n          ...book,\n          isExternal: book.isExternal || false\n        }, book.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 89,\n    columnNumber: 5\n  }, this);\n};\n_s(BooksPage, \"weANEVmC+gy3/SxukzXKEtuREvk=\");\n_c = BooksPage;\nvar _c;\n$RefreshReg$(_c, \"BooksPage\");","map":{"version":3,"names":["React","useEffect","useState","BookCard","SearchBar","api","Switch","jsxDEV","_jsxDEV","BooksPage","_s","books","setBooks","error","setError","loading","setLoading","includeExternal","setIncludeExternal","searchQuery","setSearchQuery","searchType","setSearchType","fetchBooks","query","type","useExternal","data","searchBooks","getBooks","getValue","item","value","processedData","map","book","pace","tone","Array","isArray","t","themes","console","log","err","Error","message","handleSearch","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onSearch","onMoodSelect","mood","checked","onChange","prev","length","isExternal","id","_c","$RefreshReg$"],"sources":["/Users/Projects/ChapterOne/src/components/features/BooksPage.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { BookCard } from './BookCard';\nimport { SearchBar } from './SearchBar';\nimport { api } from '../../services/api';\nimport { Book, Pace } from '../../types';\nimport { Switch } from '../ui/Switch';\n\ninterface PaceObject {\n  type: string;\n  value: Pace;\n}\n\nexport const BooksPage = () => {\n  const [books, setBooks] = useState<Book[]>([]);\n  const [error, setError] = useState<string | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [includeExternal, setIncludeExternal] = useState(true);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [searchType, setSearchType] = useState('all');\n\n  const fetchBooks = async (\n    query: string = '', \n    type: string = 'all', \n    useExternal: boolean = includeExternal\n  ) => {\n    setLoading(true);\n    setError(null);\n    \n    try {\n      let data: Book[];\n      \n      if (query) {\n        data = await api.searchBooks(query, type, useExternal);\n      } else {\n        data = await api.getBooks(useExternal);\n      }\n\n      // Helper function to extract value from object or return the value itself\n      const getValue = (item: any): string => {\n        if (typeof item === 'object' && item !== null && 'value' in item) {\n          return item.value;\n        }\n        return item;\n      };\n      \n      // Process the books to handle all fields that might be objects\n      const processedData = data.map(book => ({\n        ...book,\n        pace: (getValue(book.pace) || \"Moderate\") as Pace,\n        tone: Array.isArray(book.tone)\n          ? book.tone.map(t => getValue(t))\n          : [],\n        themes: Array.isArray(book.themes)\n          ? book.themes.map(t => getValue(t))\n          : [],\n      }));\n      \n      console.log('Processed books:', processedData);\n      setBooks(processedData);\n    } catch (err) {\n      console.error('Error processing books:', err);\n      setError(err instanceof Error ? err.message : 'Failed to load data. Please try again later.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchBooks(searchQuery, searchType, includeExternal);\n  }, [includeExternal]); // Re-fetch when external toggle changes\n\n  const handleSearch = (query: string, type?: string) => {\n    setSearchQuery(query);\n    if (type) {\n      setSearchType(type);\n    }\n    fetchBooks(query, type || searchType);\n  };\n\n  if (loading) {\n    return <div className=\"text-center py-10\">Loading books...</div>;\n  }\n\n  if (error) {\n    return <div className=\"text-center py-10 text-red-600\">Error: {error}</div>;\n  }\n\n  return (\n    <div className=\"space-y-8\">\n      {/* Header */}\n      <div className=\"text-center space-y-4\">\n        <h1 className=\"text-3xl font-bold text-primary-900\">Book Recommendations</h1>\n        <p className=\"text-lg text-primary-600\">\n          Discover books that match your interests and reading style\n        </p>\n      </div>\n\n      {/* Search */}\n      <div className=\"max-w-3xl mx-auto\">\n        <SearchBar \n          onSearch={handleSearch}\n          onMoodSelect={(mood) => handleSearch(mood, 'mood')}\n        />\n        \n        {/* External API Toggle */}\n        <div className=\"flex items-center justify-end mt-4 space-x-2\">\n          <span className=\"text-sm text-gray-600\">Include more books from external sources</span>\n          <Switch\n            checked={includeExternal}\n            onChange={() => setIncludeExternal(prev => !prev)}\n            className=\"data-[state=checked]:bg-green-500\"\n          />\n        </div>\n      </div>\n\n      {/* Books Grid */}\n      {books.length === 0 ? (\n        <div className=\"text-center py-10\">No books found. Try a different search or enable external sources.</div>\n      ) : (\n        <div>\n          {/* Search result info */}\n          <div className=\"mb-4 text-sm text-gray-600\">\n            Found {books.length} books {searchQuery ? `for \"${searchQuery}\"` : ''}\n            {searchType !== 'all' && ` by ${searchType}`}\n          </div>\n          \n          {/* Books grid */}\n          <div className=\"grid gap-6 grid-cols-1 lg:grid-cols-2\">\n            {books.map((book) => (\n              <BookCard\n                key={book.id}\n                {...book}\n                isExternal={book.isExternal || false}\n              />\n            ))}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}