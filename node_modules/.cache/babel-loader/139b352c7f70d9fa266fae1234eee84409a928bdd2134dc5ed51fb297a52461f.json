{"ast":null,"code":"import React,{useState,useEffect,useCallback,useRef}from'react';import{MagnifyingGlassIcon,AdjustmentsHorizontalIcon,XMarkIcon}from'@heroicons/react/24/outline';import{debounce}from'lodash';import{api}from'../../services/api';import{Link}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export const SearchBar=_ref=>{var _searchTypes$find;let{onSearch,onMoodSelect}=_ref;const[query,setQuery]=useState('');const[showFilters,setShowFilters]=useState(false);const[searchType,setSearchType]=useState('all');const[suggestions,setSuggestions]=useState([]);const[isLoading,setIsLoading]=useState(false);const[showSuggestions,setShowSuggestions]=useState(false);const[activeFilters,setActiveFilters]=useState([]);const[isDismissing,setIsDismissing]=useState(false);const[showTypeDropdown,setShowTypeDropdown]=useState(false);// Track if the click originated from the filter button to prevent immediate closing\nconst filterButtonClickedRef=useRef(false);const typeDropdownClickedRef=useRef(false);const searchContainerRef=useRef(null);const inputRef=useRef(null);const typeDropdownRef=useRef(null);const filterButtonRef=useRef(null);// Click outside handlers - One handler for document-wide events\nuseEffect(()=>{// Handler for document clicks\nconst handleOutsideInteraction=event=>{// Skip if click originated from filter button or type dropdown button\nif(filterButtonClickedRef.current||typeDropdownClickedRef.current){return;}// Check if the click was outside the search container\n// This is the key to detecting outside clicks reliably\nif(!(searchContainerRef.current&&searchContainerRef.current.contains(event.target))){// Close any open dropdowns with animation\nif(showSuggestions||showFilters||showTypeDropdown){setIsDismissing(true);setTimeout(()=>{setShowSuggestions(false);setShowFilters(false);setShowTypeDropdown(false);setIsDismissing(false);},150);}}};// Use the capture phase for more reliable detection\ndocument.addEventListener('click',handleOutsideInteraction,true);// Cleanup\nreturn()=>{document.removeEventListener('click',handleOutsideInteraction,true);};},[showSuggestions,showFilters,showTypeDropdown]);// Close suggestions when search type changes\nuseEffect(()=>{setShowSuggestions(false);},[searchType]);// Separate handler for filter button\nconst handleFilterButtonClick=e=>{e.stopPropagation();// Set ref to indicate this click came from the filter button\nfilterButtonClickedRef.current=true;// If type dropdown is open, close it\nif(showTypeDropdown){setIsDismissing(true);setTimeout(()=>{setShowTypeDropdown(false);setIsDismissing(false);},150);}// If suggestions are open, close them\nif(showSuggestions){setShowSuggestions(false);}// Toggle the filter dropdown state\nif(showFilters){setIsDismissing(true);setTimeout(()=>{setShowFilters(false);setIsDismissing(false);// Reset flag after closing\nfilterButtonClickedRef.current=false;},150);}else{setShowFilters(true);// Reset flag after a short delay to prevent document click from closing immediately\nsetTimeout(()=>{filterButtonClickedRef.current=false;},0);}};// Separate handler for type dropdown button\nconst handleTypeDropdownClick=e=>{e.stopPropagation();// Set ref to indicate this click came from the type dropdown button\ntypeDropdownClickedRef.current=true;// Close filters if open\nif(showFilters){setIsDismissing(true);setTimeout(()=>{setShowFilters(false);setIsDismissing(false);},150);}// Close suggestions if open\nif(showSuggestions){setShowSuggestions(false);}// Toggle type dropdown\nif(showTypeDropdown){setIsDismissing(true);setTimeout(()=>{setShowTypeDropdown(false);setIsDismissing(false);// Reset flag after closing\ntypeDropdownClickedRef.current=false;},150);}else{setShowTypeDropdown(true);// Reset flag after a short delay\nsetTimeout(()=>{typeDropdownClickedRef.current=false;},0);}};// Modified handleSubmit to also close suggestion dropdown\nconst handleSubmit=e=>{e.preventDefault();setShowSuggestions(false);setShowFilters(false);onSearch(query,searchType);};// Get quick suggestions based on search type and input\nconst getQuickSuggestions=input=>{const searchText=input.toLowerCase();switch(searchType){case'mood':return moods.filter(mood=>mood.toLowerCase().includes(searchText)).map(mood=>({id:\"mood-\".concat(mood),title:mood,type:'mood'}));case'theme':return themes.filter(theme=>theme.toLowerCase().includes(searchText)).map(theme=>({id:\"theme-\".concat(theme),title:theme,type:'theme'}));case'pace':return readingStyles.filter(style=>style.label.toLowerCase().includes(searchText)).map(style=>({id:\"pace-\".concat(style.id),title:style.label,type:'pace'}));case'profession':return professions.filter(prof=>prof.label.toLowerCase().includes(searchText)).map(prof=>({id:\"profession-\".concat(prof.id),title:prof.label,type:'profession'}));default:return[];}};// Modify the existing debouncedFetchSuggestions\nconst debouncedFetchSuggestions=useCallback(debounce(async(searchQuery,type)=>{if(!searchQuery.trim()){setSuggestions([]);return;}setIsLoading(true);try{// First, get quick suggestions based on search type\nconst quickSuggestions=getQuickSuggestions(searchQuery);// If we have quick suggestions and the search type is mood/theme/pace,\n// use those instead of API call\nif(quickSuggestions.length>0&&['mood','theme','pace'].includes(type)){setSuggestions(quickSuggestions);setIsLoading(false);return;}// Otherwise, get suggestions from API\nconst results=await api.searchBooks(searchQuery,type,false);// Process results into suggestions\nconst newSuggestions=results.slice(0,5).map(book=>({id:book.id,title:book.title,type:'book'}));// Add author suggestions if searching all or authors\nif(type==='all'||type==='author'){const authorSuggestions=results.slice(0,3).filter(book=>book.author).map(book=>({id:\"author-\".concat(book.id),title:book.author,type:'author'}));newSuggestions.push(...authorSuggestions);}setSuggestions(newSuggestions);}catch(error){console.error('Error fetching suggestions:',error);setSuggestions([]);}finally{setIsLoading(false);}},300),[searchType]// Add searchType as dependency since we're using it in the callback\n);useEffect(()=>{debouncedFetchSuggestions(query,searchType);return()=>{debouncedFetchSuggestions.cancel();};},[query,searchType,debouncedFetchSuggestions]);// Modified handleSuggestionClick to handle event propagation\nconst handleSuggestionClick=(suggestion,e)=>{// Prevent event propagation\nif(e){e.stopPropagation();}setQuery(suggestion.title);setShowSuggestions(false);setShowFilters(false);switch(suggestion.type){case'mood':handleMoodSelect(suggestion.title);break;case'theme':handleThemeSelect(suggestion.title);break;case'pace':const style=readingStyles.find(s=>s.label===suggestion.title);if(style){handleReadingStyleSelect(style.id);}break;case'profession':const prof=professions.find(p=>p.label===suggestion.title);if(prof){handleProfessionSelect(prof.id,prof.label);}break;case'author':onSearch(suggestion.title,'author');break;default:onSearch(suggestion.title,'title');}};// Update clearSearch to be consistent with other handlers\nconst clearSearch=()=>{setQuery('');setSuggestions([]);// Close dropdowns with animation if any are open\nif(showSuggestions||showFilters||showTypeDropdown){setIsDismissing(true);setTimeout(()=>{setShowSuggestions(false);setShowFilters(false);setShowTypeDropdown(false);setIsDismissing(false);},150);}setActiveFilters([]);setSearchType('all');onSearch('','all');// Focus the input after clearing\nsetTimeout(()=>{var _inputRef$current;return(_inputRef$current=inputRef.current)===null||_inputRef$current===void 0?void 0:_inputRef$current.focus();},50);};const removeFilter=filter=>{setActiveFilters(filters=>filters.filter(f=>f!==filter));if(query===filter){setQuery('');onSearch('','all');}};// Define search types\nconst searchTypes=[{id:'all',label:'All'},{id:'title',label:'Book Titles'},{id:'author',label:'Authors'},{id:'mood',label:'Moods'},{id:'theme',label:'Themes'},{id:'pace',label:'Reading Style'},{id:'profession',label:'Profession'},{id:'color',label:'ðŸŽ¨ Search by Color',isSpecial:true}];// Define moods and reading preferences\nconst moods=['Feeling overwhelmed','Need inspiration','Want to escape','Looking for adventure','Feeling nostalgic','Want to learn','Need a laugh','Feeling romantic'];const themes=['Love','Adventure','Mystery','Fantasy','Science Fiction','History','Philosophy','Science','Coming of Age','Family','Friendship','Identity'];const readingStyles=[{id:'Fast',label:'Fast-paced reads'},{id:'Moderate',label:'Balanced pacing'},{id:'Slow',label:'Slow, thoughtful reads'}];const professions=[{id:'product-management',label:'Product Management'},{id:'design',label:'UX/UI Design'},{id:'sales',label:'Sales'},{id:'marketing',label:'Marketing'},{id:'engineering',label:'Software Engineering'},{id:'data-science',label:'Data Science'},{id:'leadership',label:'Leadership'},{id:'project-management',label:'Project Management'},{id:'finance',label:'Finance'},{id:'human-resources',label:'Human Resources'},{id:'entrepreneurship',label:'Entrepreneurship'},{id:'consulting',label:'Consulting'}];const handleMoodSelect=mood=>{setQuery(mood);setSearchType('mood');// Apply animation before closing\nsetIsDismissing(true);setTimeout(()=>{setShowFilters(false);setShowSuggestions(false);setIsDismissing(false);},150);setActiveFilters(prev=>[...prev.filter(f=>f!==mood),mood]);onSearch(mood,'mood');onMoodSelect===null||onMoodSelect===void 0?void 0:onMoodSelect(mood);};const handleThemeSelect=theme=>{setQuery(theme);setSearchType('theme');// Apply animation before closing\nsetIsDismissing(true);setTimeout(()=>{setShowFilters(false);setShowSuggestions(false);setIsDismissing(false);},150);setActiveFilters(prev=>[...prev.filter(f=>f!==theme),theme]);onSearch(theme,'theme');};const handleReadingStyleSelect=style=>{setQuery(style);setSearchType('pace');// Apply animation before closing\nsetIsDismissing(true);setTimeout(()=>{setShowFilters(false);setShowSuggestions(false);setIsDismissing(false);},150);setActiveFilters(prev=>[...prev.filter(f=>f!==style),style]);onSearch(style,'pace');};const handleProfessionSelect=(professionId,label)=>{setQuery(label);setSearchType('profession');// Apply animation before closing\nsetIsDismissing(true);setTimeout(()=>{setShowFilters(false);setShowSuggestions(false);setIsDismissing(false);},150);setActiveFilters(prev=>[...prev.filter(f=>f!==label),label]);onSearch(professionId,'profession');};// Update input focus handler to use animation and be consistent with other handlers\nconst handleInputFocus=()=>{// If filters are shown, hide them with animation\nif(showFilters){setIsDismissing(true);setTimeout(()=>{setShowFilters(false);setIsDismissing(false);},150);}// If type dropdown is shown, hide it with animation\nif(showTypeDropdown){setIsDismissing(true);setTimeout(()=>{setShowTypeDropdown(false);setIsDismissing(false);},150);}// Only show suggestions if we have a query\nif(query.trim()){setShowSuggestions(true);}};// Create custom dropdown component to replace the select element\n// Close type dropdown when clicking outside\nuseEffect(()=>{const handleClickOutsideTypeDropdown=event=>{if(typeDropdownRef.current&&!typeDropdownRef.current.contains(event.target)){setShowTypeDropdown(false);}};document.addEventListener('mousedown',handleClickOutsideTypeDropdown);return()=>{document.removeEventListener('mousedown',handleClickOutsideTypeDropdown);};},[]);const handleTypeSelect=(typeId,e)=>{// Prevent event propagation\nif(e){e.stopPropagation();}// Special handling for color search\nif(typeId==='color'){// Redirect to color search page\nwindow.location.href='/color-search';return;}setSearchType(typeId);// Apply animation before closing\nsetIsDismissing(true);setTimeout(()=>{var _inputRef$current2;setShowTypeDropdown(false);setIsDismissing(false);// Focus search input after selecting type\n(_inputRef$current2=inputRef.current)===null||_inputRef$current2===void 0?void 0:_inputRef$current2.focus();},150);};return/*#__PURE__*/_jsxs(\"div\",{className:\"w-full relative space-y-3\",ref:searchContainerRef,children:[/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"relative\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative flex\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-grow relative\",children:[/*#__PURE__*/_jsx(\"input\",{ref:inputRef,type:\"text\",value:query,onChange:e=>{setQuery(e.target.value);if(e.target.value.trim()){setShowSuggestions(true);}else{setShowSuggestions(false);}},onFocus:handleInputFocus,placeholder:searchType==='mood'?\"Type to search moods...\":searchType==='theme'?\"Type to search themes...\":searchType==='pace'?\"Type to search reading styles...\":searchType==='profession'?\"Search books by profession...\":\"Search for books, authors, or moods...\",className:\"input pl-10 pr-24 w-full\"}),/*#__PURE__*/_jsx(MagnifyingGlassIcon,{className:\"w-5 h-5 text-primary-500 absolute left-3 top-1/2 -translate-y-1/2 transition-colors duration-200\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute right-3 top-1/2 -translate-y-1/2 flex items-center gap-2\",children:[isLoading&&/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-5 w-5 border-b-2 border-primary-600 transition-opacity duration-200 animate-fade-in\"}),query&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:clearSearch,className:\"p-1 hover:bg-primary-50 rounded-full text-primary-400 hover:text-primary-600 transition-all duration-200 animate-fade-in\",children:/*#__PURE__*/_jsx(XMarkIcon,{className:\"w-5 h-5\"})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"ml-2 relative\",ref:typeDropdownRef,children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:handleTypeDropdownClick,className:\"px-3 py-2 rounded-lg border border-primary-200 hover:bg-primary-50 text-primary-500 hover:text-primary-700 transition-all duration-200 transform hover:scale-105 flex items-center justify-between min-w-[120px] \".concat(showTypeDropdown?'bg-primary-50 scale-105':''),children:[/*#__PURE__*/_jsx(\"span\",{children:((_searchTypes$find=searchTypes.find(type=>type.id===searchType))===null||_searchTypes$find===void 0?void 0:_searchTypes$find.label)||'All'}),/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"h-4 w-4 ml-2 transition-transform duration-200 \".concat(showTypeDropdown?'rotate-180':''),fill:\"none\",viewBox:\"0 0 24 24\",stroke:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M19 9l-7 7-7-7\"})})]}),showTypeDropdown&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute z-30 mt-1 w-full bg-white rounded-lg shadow-lg border border-primary-200 \".concat(isDismissing?'animate-fade-out':'animate-slide-down'),children:/*#__PURE__*/_jsx(\"ul\",{className:\"py-1\",children:searchTypes.map(type=>/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:e=>handleTypeSelect(type.id,e),className:\"w-full text-left px-4 py-2 hover:bg-primary-50 transition-colors duration-200 \".concat(searchType===type.id?'bg-primary-100 text-primary-700':'text-primary-600'),children:type.label})},type.id))})})]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",ref:filterButtonRef,onClick:handleFilterButtonClick,className:\"ml-2 p-2 rounded-lg border border-primary-200 hover:bg-primary-50 text-primary-500 hover:text-primary-700 transition-all duration-200 transform hover:scale-105 \".concat(showFilters?'bg-primary-50 scale-105':''),\"aria-label\":\"Toggle filters\",children:/*#__PURE__*/_jsx(AdjustmentsHorizontalIcon,{className:\"w-5 h-5\"})})]}),activeFilters.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap gap-2 mt-3 animate-slide-up\",children:[activeFilters.map(filter=>/*#__PURE__*/_jsxs(\"span\",{className:\"inline-flex items-center px-3 py-1 rounded-full text-sm bg-primary-100 text-primary-700 animate-scale-in\",children:[filter,/*#__PURE__*/_jsx(\"button\",{onClick:()=>removeFilter(filter),className:\"ml-2 text-primary-500 hover:text-primary-700 transition-colors duration-200\",\"aria-label\":\"Remove \".concat(filter,\" filter\"),children:/*#__PURE__*/_jsx(XMarkIcon,{className:\"w-4 h-4\"})})]},filter)),activeFilters.length>1&&/*#__PURE__*/_jsx(\"button\",{onClick:clearSearch,className:\"text-sm text-primary-600 hover:text-primary-800 transition-colors duration-200\",children:\"Clear all\"})]}),showSuggestions&&suggestions.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute z-20 mt-1 w-full bg-white rounded-lg shadow-lg border border-primary-200 \".concat(isDismissing?'animate-fade-out':'animate-slide-down'),children:/*#__PURE__*/_jsx(\"ul\",{className:\"py-2\",children:suggestions.map(suggestion=>/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:e=>handleSuggestionClick(suggestion,e),className:\"w-full text-left px-4 py-2 hover:bg-primary-50 flex items-center transition-colors duration-200\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"flex-grow\",children:suggestion.title}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-primary-400 ml-2\",children:suggestion.type.charAt(0).toUpperCase()+suggestion.type.slice(1)})]})},suggestion.id))})})]}),showFilters&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute z-10 mt-2 w-full bg-white rounded-lg shadow-lg border border-primary-200 \".concat(isDismissing?'animate-fade-out':'animate-slide-down'),children:/*#__PURE__*/_jsx(\"div\",{className:\"p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-3 gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"lg:col-span-1 animate-fade-in\",style:{animationDelay:'50ms'},children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-sm font-medium text-primary-900 mb-2\",children:\"Search by mood\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-col gap-2 max-h-[250px] overflow-y-auto pr-1\",children:moods.map(mood=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleMoodSelect(mood),className:\"text-left text-sm p-2 rounded-lg transition-all duration-200 \".concat(activeFilters.includes(mood)?'bg-primary-100 text-primary-700':'text-primary-700 hover:bg-primary-50'),children:mood},mood))}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-4 pt-4 border-t border-primary-200\",children:/*#__PURE__*/_jsxs(Link,{to:\"/color-search\",className:\"flex items-center justify-center w-full p-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-lg hover:from-purple-600 hover:to-pink-600 transition-all duration-200 transform hover:scale-105 shadow-lg\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"mr-2\",children:\"\\uD83C\\uDFA8\"}),\"Try Color Search\",/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4 ml-2\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M13 7l5 5m0 0l-5 5m5-5H6\"})})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"animate-fade-in\",style:{animationDelay:'100ms'},children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-sm font-medium text-primary-900 mb-2\",children:\"Search by theme\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-col gap-2 max-h-[300px] overflow-y-auto pr-1\",children:themes.map(theme=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleThemeSelect(theme),className:\"text-left text-sm p-2 rounded-lg transition-all duration-200 \".concat(activeFilters.includes(theme)?'bg-primary-100 text-primary-700':'text-primary-700 hover:bg-primary-50'),children:theme},theme))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"animate-fade-in\",style:{animationDelay:'150ms'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-sm font-medium text-primary-900 mb-2\",children:\"Search by reading style\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-col gap-2\",children:readingStyles.map(style=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleReadingStyleSelect(style.id),className:\"text-left text-sm p-2 rounded-lg transition-all duration-200 \".concat(activeFilters.includes(style.id)?'bg-primary-100 text-primary-700':'text-primary-700 hover:bg-primary-50'),children:style.label},style.id))})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-sm font-medium text-primary-900 mb-2\",children:\"Search by profession\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-col gap-2 max-h-[200px] overflow-y-auto pr-1\",children:professions.map(profession=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleProfessionSelect(profession.id,profession.label),className:\"text-left text-sm p-2 rounded-lg transition-all duration-200 \".concat(activeFilters.includes(profession.label)?'bg-primary-100 text-primary-700':'text-primary-700 hover:bg-primary-50'),children:profession.label},profession.id))})]})]})]})})})]});};","map":{"version":3,"names":["React","useState","useEffect","useCallback","useRef","MagnifyingGlassIcon","AdjustmentsHorizontalIcon","XMarkIcon","debounce","api","Link","jsx","_jsx","jsxs","_jsxs","SearchBar","_ref","_searchTypes$find","onSearch","onMoodSelect","query","setQuery","showFilters","setShowFilters","searchType","setSearchType","suggestions","setSuggestions","isLoading","setIsLoading","showSuggestions","setShowSuggestions","activeFilters","setActiveFilters","isDismissing","setIsDismissing","showTypeDropdown","setShowTypeDropdown","filterButtonClickedRef","typeDropdownClickedRef","searchContainerRef","inputRef","typeDropdownRef","filterButtonRef","handleOutsideInteraction","event","current","contains","target","setTimeout","document","addEventListener","removeEventListener","handleFilterButtonClick","e","stopPropagation","handleTypeDropdownClick","handleSubmit","preventDefault","getQuickSuggestions","input","searchText","toLowerCase","moods","filter","mood","includes","map","id","concat","title","type","themes","theme","readingStyles","style","label","professions","prof","debouncedFetchSuggestions","searchQuery","trim","quickSuggestions","length","results","searchBooks","newSuggestions","slice","book","authorSuggestions","author","push","error","console","cancel","handleSuggestionClick","suggestion","handleMoodSelect","handleThemeSelect","find","s","handleReadingStyleSelect","p","handleProfessionSelect","clearSearch","_inputRef$current","focus","removeFilter","filters","f","searchTypes","isSpecial","prev","professionId","handleInputFocus","handleClickOutsideTypeDropdown","handleTypeSelect","typeId","window","location","href","_inputRef$current2","className","ref","children","onSubmit","value","onChange","onFocus","placeholder","onClick","xmlns","fill","viewBox","stroke","strokeLinecap","strokeLinejoin","strokeWidth","d","charAt","toUpperCase","animationDelay","to","profession"],"sources":["/Users/Projects/ChapterOne/src/components/features/SearchBar.tsx"],"sourcesContent":["import React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { MagnifyingGlassIcon, AdjustmentsHorizontalIcon, XMarkIcon } from '@heroicons/react/24/outline';\nimport { debounce } from 'lodash';\nimport { api } from '../../services/api';\nimport { Link } from 'react-router-dom';\n\ninterface SearchBarProps {\n  onSearch: (query: string, type?: string) => void;\n  onMoodSelect?: (mood: string) => void;\n}\n\ninterface Suggestion {\n  id: string;\n  title: string;\n  type: 'book' | 'author' | 'theme' | 'mood' | 'pace' | 'profession';\n}\n\ntype DebouncedFunction = {\n  (searchQuery: string, type: string): Promise<void>;\n  cancel: () => void;\n};\n\nexport const SearchBar = ({ onSearch, onMoodSelect }: SearchBarProps) => {\n  const [query, setQuery] = useState('');\n  const [showFilters, setShowFilters] = useState(false);\n  const [searchType, setSearchType] = useState('all');\n  const [suggestions, setSuggestions] = useState<Suggestion[]>([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [showSuggestions, setShowSuggestions] = useState(false);\n  const [activeFilters, setActiveFilters] = useState<string[]>([]);\n  const [isDismissing, setIsDismissing] = useState(false);\n  const [showTypeDropdown, setShowTypeDropdown] = useState(false);\n  \n  // Track if the click originated from the filter button to prevent immediate closing\n  const filterButtonClickedRef = useRef(false);\n  const typeDropdownClickedRef = useRef(false);\n  \n  const searchContainerRef = useRef<HTMLDivElement>(null);\n  const inputRef = useRef<HTMLInputElement>(null);\n  const typeDropdownRef = useRef<HTMLDivElement>(null);\n  const filterButtonRef = useRef<HTMLButtonElement>(null);\n\n  // Click outside handlers - One handler for document-wide events\n  useEffect(() => {\n    // Handler for document clicks\n    const handleOutsideInteraction = (event: MouseEvent) => {\n      // Skip if click originated from filter button or type dropdown button\n      if (filterButtonClickedRef.current || typeDropdownClickedRef.current) {\n        return;\n      }\n\n      // Check if the click was outside the search container\n      // This is the key to detecting outside clicks reliably\n      if (!(searchContainerRef.current && searchContainerRef.current.contains(event.target as Node))) {\n        // Close any open dropdowns with animation\n        if (showSuggestions || showFilters || showTypeDropdown) {\n          setIsDismissing(true);\n          setTimeout(() => {\n            setShowSuggestions(false);\n            setShowFilters(false);\n            setShowTypeDropdown(false);\n            setIsDismissing(false);\n          }, 150);\n        }\n      }\n    };\n\n    // Use the capture phase for more reliable detection\n    document.addEventListener('click', handleOutsideInteraction, true);\n    \n    // Cleanup\n    return () => {\n      document.removeEventListener('click', handleOutsideInteraction, true);\n    };\n  }, [showSuggestions, showFilters, showTypeDropdown]);\n  \n  // Close suggestions when search type changes\n  useEffect(() => {\n    setShowSuggestions(false);\n  }, [searchType]);\n\n  // Separate handler for filter button\n  const handleFilterButtonClick = (e: React.MouseEvent) => {\n    e.stopPropagation();\n    \n    // Set ref to indicate this click came from the filter button\n    filterButtonClickedRef.current = true;\n    \n    // If type dropdown is open, close it\n    if (showTypeDropdown) {\n      setIsDismissing(true);\n      setTimeout(() => {\n        setShowTypeDropdown(false);\n        setIsDismissing(false);\n      }, 150);\n    }\n    \n    // If suggestions are open, close them\n    if (showSuggestions) {\n      setShowSuggestions(false);\n    }\n\n    // Toggle the filter dropdown state\n    if (showFilters) {\n      setIsDismissing(true);\n      setTimeout(() => {\n        setShowFilters(false);\n        setIsDismissing(false);\n        // Reset flag after closing\n        filterButtonClickedRef.current = false;\n      }, 150);\n    } else {\n      setShowFilters(true);\n      // Reset flag after a short delay to prevent document click from closing immediately\n      setTimeout(() => {\n        filterButtonClickedRef.current = false;\n      }, 0);\n    }\n  };\n\n  // Separate handler for type dropdown button\n  const handleTypeDropdownClick = (e: React.MouseEvent) => {\n    e.stopPropagation();\n    \n    // Set ref to indicate this click came from the type dropdown button\n    typeDropdownClickedRef.current = true;\n    \n    // Close filters if open\n    if (showFilters) {\n      setIsDismissing(true);\n      setTimeout(() => {\n        setShowFilters(false);\n        setIsDismissing(false);\n      }, 150);\n    }\n    \n    // Close suggestions if open\n    if (showSuggestions) {\n      setShowSuggestions(false);\n    }\n    \n    // Toggle type dropdown\n    if (showTypeDropdown) {\n      setIsDismissing(true);\n      setTimeout(() => {\n        setShowTypeDropdown(false);\n        setIsDismissing(false);\n        // Reset flag after closing\n        typeDropdownClickedRef.current = false;\n      }, 150);\n    } else {\n      setShowTypeDropdown(true);\n      // Reset flag after a short delay\n      setTimeout(() => {\n        typeDropdownClickedRef.current = false;\n      }, 0);\n    }\n  };\n\n  // Modified handleSubmit to also close suggestion dropdown\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    setShowSuggestions(false);\n    setShowFilters(false);\n    onSearch(query, searchType);\n  };\n\n  // Get quick suggestions based on search type and input\n  const getQuickSuggestions = (input: string): Suggestion[] => {\n    const searchText = input.toLowerCase();\n    \n    switch (searchType) {\n      case 'mood':\n        return moods\n          .filter(mood => mood.toLowerCase().includes(searchText))\n          .map(mood => ({\n            id: `mood-${mood}`,\n            title: mood,\n            type: 'mood' as const\n          }));\n      case 'theme':\n        return themes\n          .filter(theme => theme.toLowerCase().includes(searchText))\n          .map(theme => ({\n            id: `theme-${theme}`,\n            title: theme,\n            type: 'theme' as const\n          }));\n      case 'pace':\n        return readingStyles\n          .filter(style => style.label.toLowerCase().includes(searchText))\n          .map(style => ({\n            id: `pace-${style.id}`,\n            title: style.label,\n            type: 'pace' as const\n          }));\n      case 'profession':\n        return professions\n          .filter(prof => prof.label.toLowerCase().includes(searchText))\n          .map(prof => ({\n            id: `profession-${prof.id}`,\n            title: prof.label,\n            type: 'profession' as const\n          }));\n      default:\n        return [];\n    }\n  };\n\n  // Modify the existing debouncedFetchSuggestions\n  const debouncedFetchSuggestions = useCallback(\n    debounce(async (searchQuery: string, type: string) => {\n      if (!searchQuery.trim()) {\n        setSuggestions([]);\n        return;\n      }\n\n      setIsLoading(true);\n      try {\n        // First, get quick suggestions based on search type\n        const quickSuggestions = getQuickSuggestions(searchQuery);\n        \n        // If we have quick suggestions and the search type is mood/theme/pace,\n        // use those instead of API call\n        if (quickSuggestions.length > 0 && ['mood', 'theme', 'pace'].includes(type)) {\n          setSuggestions(quickSuggestions);\n          setIsLoading(false);\n          return;\n        }\n\n        // Otherwise, get suggestions from API\n        const results = await api.searchBooks(searchQuery, type, false);\n        \n        // Process results into suggestions\n        const newSuggestions: Suggestion[] = results.slice(0, 5).map(book => ({\n          id: book.id,\n          title: book.title,\n          type: 'book' as const\n        }));\n\n        // Add author suggestions if searching all or authors\n        if (type === 'all' || type === 'author') {\n          const authorSuggestions = results\n            .slice(0, 3)\n            .filter(book => book.author)\n            .map(book => ({\n              id: `author-${book.id}`,\n              title: book.author,\n              type: 'author' as const\n            }));\n          newSuggestions.push(...authorSuggestions);\n        }\n\n        setSuggestions(newSuggestions);\n      } catch (error) {\n        console.error('Error fetching suggestions:', error);\n        setSuggestions([]);\n      } finally {\n        setIsLoading(false);\n      }\n    }, 300),\n    [searchType] // Add searchType as dependency since we're using it in the callback\n  ) as DebouncedFunction;\n\n  useEffect(() => {\n    debouncedFetchSuggestions(query, searchType);\n    return () => {\n      debouncedFetchSuggestions.cancel();\n    };\n  }, [query, searchType, debouncedFetchSuggestions]);\n\n  // Modified handleSuggestionClick to handle event propagation\n  const handleSuggestionClick = (suggestion: Suggestion, e?: React.MouseEvent) => {\n    // Prevent event propagation\n    if (e) {\n      e.stopPropagation();\n    }\n    \n    setQuery(suggestion.title);\n    setShowSuggestions(false);\n    setShowFilters(false);\n    \n    switch (suggestion.type) {\n      case 'mood':\n        handleMoodSelect(suggestion.title);\n        break;\n      case 'theme':\n        handleThemeSelect(suggestion.title);\n        break;\n      case 'pace':\n        const style = readingStyles.find(s => s.label === suggestion.title);\n        if (style) {\n          handleReadingStyleSelect(style.id);\n        }\n        break;\n      case 'profession':\n        const prof = professions.find(p => p.label === suggestion.title);\n        if (prof) {\n          handleProfessionSelect(prof.id, prof.label);\n        }\n        break;\n      case 'author':\n        onSearch(suggestion.title, 'author');\n        break;\n      default:\n        onSearch(suggestion.title, 'title');\n    }\n  };\n\n  // Update clearSearch to be consistent with other handlers\n  const clearSearch = () => {\n    setQuery('');\n    setSuggestions([]);\n    \n    // Close dropdowns with animation if any are open\n    if (showSuggestions || showFilters || showTypeDropdown) {\n      setIsDismissing(true);\n      setTimeout(() => {\n        setShowSuggestions(false);\n        setShowFilters(false);\n        setShowTypeDropdown(false);\n        setIsDismissing(false);\n      }, 150);\n    }\n    \n    setActiveFilters([]);\n    setSearchType('all');\n    onSearch('', 'all');\n    \n    // Focus the input after clearing\n    setTimeout(() => inputRef.current?.focus(), 50);\n  };\n\n  const removeFilter = (filter: string) => {\n    setActiveFilters(filters => filters.filter(f => f !== filter));\n    if (query === filter) {\n      setQuery('');\n      onSearch('', 'all');\n    }\n  };\n\n  // Define search types\n  const searchTypes = [\n    { id: 'all', label: 'All' },\n    { id: 'title', label: 'Book Titles' },\n    { id: 'author', label: 'Authors' },\n    { id: 'mood', label: 'Moods' },\n    { id: 'theme', label: 'Themes' },\n    { id: 'pace', label: 'Reading Style' },\n    { id: 'profession', label: 'Profession' },\n    { id: 'color', label: 'ðŸŽ¨ Search by Color', isSpecial: true }\n  ];\n  \n  // Define moods and reading preferences\n  const moods = [\n    'Feeling overwhelmed',\n    'Need inspiration',\n    'Want to escape',\n    'Looking for adventure',\n    'Feeling nostalgic',\n    'Want to learn',\n    'Need a laugh',\n    'Feeling romantic',\n  ];\n  \n  const themes = [\n    'Love',\n    'Adventure',\n    'Mystery',\n    'Fantasy',\n    'Science Fiction',\n    'History',\n    'Philosophy',\n    'Science',\n    'Coming of Age',\n    'Family',\n    'Friendship',\n    'Identity',\n  ];\n  \n  const readingStyles = [\n    { id: 'Fast', label: 'Fast-paced reads' },\n    { id: 'Moderate', label: 'Balanced pacing' },\n    { id: 'Slow', label: 'Slow, thoughtful reads' }\n  ];\n\n  const professions = [\n    { id: 'product-management', label: 'Product Management' },\n    { id: 'design', label: 'UX/UI Design' },\n    { id: 'sales', label: 'Sales' },\n    { id: 'marketing', label: 'Marketing' },\n    { id: 'engineering', label: 'Software Engineering' },\n    { id: 'data-science', label: 'Data Science' },\n    { id: 'leadership', label: 'Leadership' },\n    { id: 'project-management', label: 'Project Management' },\n    { id: 'finance', label: 'Finance' },\n    { id: 'human-resources', label: 'Human Resources' },\n    { id: 'entrepreneurship', label: 'Entrepreneurship' },\n    { id: 'consulting', label: 'Consulting' }\n  ];\n\n  const handleMoodSelect = (mood: string) => {\n    setQuery(mood);\n    setSearchType('mood');\n    \n    // Apply animation before closing\n    setIsDismissing(true);\n    setTimeout(() => {\n      setShowFilters(false);\n      setShowSuggestions(false);\n      setIsDismissing(false);\n    }, 150);\n    \n    setActiveFilters(prev => [...prev.filter(f => f !== mood), mood]);\n    onSearch(mood, 'mood');\n    onMoodSelect?.(mood);\n  };\n  \n  const handleThemeSelect = (theme: string) => {\n    setQuery(theme);\n    setSearchType('theme');\n    \n    // Apply animation before closing\n    setIsDismissing(true);\n    setTimeout(() => {\n      setShowFilters(false);\n      setShowSuggestions(false);\n      setIsDismissing(false);\n    }, 150);\n    \n    setActiveFilters(prev => [...prev.filter(f => f !== theme), theme]);\n    onSearch(theme, 'theme');\n  };\n  \n  const handleReadingStyleSelect = (style: string) => {\n    setQuery(style);\n    setSearchType('pace');\n    \n    // Apply animation before closing\n    setIsDismissing(true);\n    setTimeout(() => {\n      setShowFilters(false);\n      setShowSuggestions(false);\n      setIsDismissing(false);\n    }, 150);\n    \n    setActiveFilters(prev => [...prev.filter(f => f !== style), style]);\n    onSearch(style, 'pace');\n  };\n\n  const handleProfessionSelect = (professionId: string, label: string) => {\n    setQuery(label);\n    setSearchType('profession');\n    \n    // Apply animation before closing\n    setIsDismissing(true);\n    setTimeout(() => {\n      setShowFilters(false);\n      setShowSuggestions(false);\n      setIsDismissing(false);\n    }, 150);\n    \n    setActiveFilters(prev => [...prev.filter(f => f !== label), label]);\n    onSearch(professionId, 'profession');\n  };\n\n  // Update input focus handler to use animation and be consistent with other handlers\n  const handleInputFocus = () => {\n    // If filters are shown, hide them with animation\n    if (showFilters) {\n      setIsDismissing(true);\n      setTimeout(() => {\n        setShowFilters(false);\n        setIsDismissing(false);\n      }, 150);\n    }\n    \n    // If type dropdown is shown, hide it with animation\n    if (showTypeDropdown) {\n      setIsDismissing(true);\n      setTimeout(() => {\n        setShowTypeDropdown(false);\n        setIsDismissing(false);\n      }, 150);\n    }\n    \n    // Only show suggestions if we have a query\n    if (query.trim()) {\n      setShowSuggestions(true);\n    }\n  };\n\n  // Create custom dropdown component to replace the select element\n  // Close type dropdown when clicking outside\n  useEffect(() => {\n    const handleClickOutsideTypeDropdown = (event: MouseEvent) => {\n      if (typeDropdownRef.current && !typeDropdownRef.current.contains(event.target as Node)) {\n        setShowTypeDropdown(false);\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutsideTypeDropdown);\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutsideTypeDropdown);\n    };\n  }, []);\n\n  const handleTypeSelect = (typeId: string, e?: React.MouseEvent) => {\n    // Prevent event propagation\n    if (e) {\n      e.stopPropagation();\n    }\n    \n    // Special handling for color search\n    if (typeId === 'color') {\n      // Redirect to color search page\n      window.location.href = '/color-search';\n      return;\n    }\n    \n    setSearchType(typeId);\n    \n    // Apply animation before closing\n    setIsDismissing(true);\n    setTimeout(() => {\n      setShowTypeDropdown(false);\n      setIsDismissing(false);\n      // Focus search input after selecting type\n      inputRef.current?.focus();\n    }, 150);\n  };\n\n  return (\n    <div className=\"w-full relative space-y-3\" ref={searchContainerRef}>\n      <form onSubmit={handleSubmit} className=\"relative\">\n        <div className=\"relative flex\">\n          <div className=\"flex-grow relative\">\n            <input\n              ref={inputRef}\n              type=\"text\"\n              value={query}\n              onChange={(e) => {\n                setQuery(e.target.value);\n                if (e.target.value.trim()) {\n                  setShowSuggestions(true);\n                } else {\n                  setShowSuggestions(false);\n                }\n              }}\n              onFocus={handleInputFocus}\n              placeholder={\n                searchType === 'mood' ? \"Type to search moods...\" :\n                searchType === 'theme' ? \"Type to search themes...\" :\n                searchType === 'pace' ? \"Type to search reading styles...\" :\n                searchType === 'profession' ? \"Search books by profession...\" :\n                \"Search for books, authors, or moods...\"\n              }\n              className=\"input pl-10 pr-24 w-full\"\n            />\n            <MagnifyingGlassIcon className=\"w-5 h-5 text-primary-500 absolute left-3 top-1/2 -translate-y-1/2 transition-colors duration-200\" />\n            <div className=\"absolute right-3 top-1/2 -translate-y-1/2 flex items-center gap-2\">\n              {isLoading && (\n                <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-primary-600 transition-opacity duration-200 animate-fade-in\"></div>\n              )}\n              {query && (\n                <button\n                  type=\"button\"\n                  onClick={clearSearch}\n                  className=\"p-1 hover:bg-primary-50 rounded-full text-primary-400 hover:text-primary-600 transition-all duration-200 animate-fade-in\"\n                >\n                  <XMarkIcon className=\"w-5 h-5\" />\n                </button>\n              )}\n            </div>\n          </div>\n          \n          {/* Custom dropdown to replace select */}\n          <div className=\"ml-2 relative\" ref={typeDropdownRef}>\n            <button\n              type=\"button\"\n              onClick={handleTypeDropdownClick}\n              className={`px-3 py-2 rounded-lg border border-primary-200 hover:bg-primary-50 text-primary-500 hover:text-primary-700 transition-all duration-200 transform hover:scale-105 flex items-center justify-between min-w-[120px] ${showTypeDropdown ? 'bg-primary-50 scale-105' : ''}`}\n            >\n              <span>{searchTypes.find(type => type.id === searchType)?.label || 'All'}</span>\n              <svg \n                xmlns=\"http://www.w3.org/2000/svg\" \n                className={`h-4 w-4 ml-2 transition-transform duration-200 ${showTypeDropdown ? 'rotate-180' : ''}`} \n                fill=\"none\" \n                viewBox=\"0 0 24 24\" \n                stroke=\"currentColor\"\n              >\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\n              </svg>\n            </button>\n            \n            {showTypeDropdown && (\n              <div className={`absolute z-30 mt-1 w-full bg-white rounded-lg shadow-lg border border-primary-200 ${isDismissing ? 'animate-fade-out' : 'animate-slide-down'}`}>\n                <ul className=\"py-1\">\n                  {searchTypes.map(type => (\n                    <li key={type.id}>\n                      <button\n                        type=\"button\"\n                        onClick={(e) => handleTypeSelect(type.id, e)}\n                        className={`w-full text-left px-4 py-2 hover:bg-primary-50 transition-colors duration-200 ${\n                          searchType === type.id ? 'bg-primary-100 text-primary-700' : 'text-primary-600'\n                        }`}\n                      >\n                        {type.label}\n                      </button>\n                    </li>\n                  ))}\n                </ul>\n              </div>\n            )}\n          </div>\n          \n          <button\n            type=\"button\"\n            ref={filterButtonRef}\n            onClick={handleFilterButtonClick}\n            className={`ml-2 p-2 rounded-lg border border-primary-200 hover:bg-primary-50 text-primary-500 hover:text-primary-700 transition-all duration-200 transform hover:scale-105 ${showFilters ? 'bg-primary-50 scale-105' : ''}`}\n            aria-label=\"Toggle filters\"\n          >\n            <AdjustmentsHorizontalIcon className=\"w-5 h-5\" />\n          </button>\n        </div>\n\n        {/* Active Filters */}\n        {activeFilters.length > 0 && (\n          <div className=\"flex flex-wrap gap-2 mt-3 animate-slide-up\">\n            {activeFilters.map((filter) => (\n              <span\n                key={filter}\n                className=\"inline-flex items-center px-3 py-1 rounded-full text-sm bg-primary-100 text-primary-700 animate-scale-in\"\n              >\n                {filter}\n                <button\n                  onClick={() => removeFilter(filter)}\n                  className=\"ml-2 text-primary-500 hover:text-primary-700 transition-colors duration-200\"\n                  aria-label={`Remove ${filter} filter`}\n                >\n                  <XMarkIcon className=\"w-4 h-4\" />\n                </button>\n              </span>\n            ))}\n            {activeFilters.length > 1 && (\n              <button\n                onClick={clearSearch}\n                className=\"text-sm text-primary-600 hover:text-primary-800 transition-colors duration-200\"\n              >\n                Clear all\n              </button>\n            )}\n          </div>\n        )}\n\n        {/* Suggestions dropdown */}\n        {showSuggestions && suggestions.length > 0 && (\n          <div className={`absolute z-20 mt-1 w-full bg-white rounded-lg shadow-lg border border-primary-200 ${isDismissing ? 'animate-fade-out' : 'animate-slide-down'}`}>\n            <ul className=\"py-2\">\n              {suggestions.map((suggestion) => (\n                <li key={suggestion.id}>\n                  <button\n                    type=\"button\"\n                    onClick={(e) => handleSuggestionClick(suggestion, e)}\n                    className=\"w-full text-left px-4 py-2 hover:bg-primary-50 flex items-center transition-colors duration-200\"\n                  >\n                    <span className=\"flex-grow\">{suggestion.title}</span>\n                    <span className=\"text-sm text-primary-400 ml-2\">\n                      {suggestion.type.charAt(0).toUpperCase() + suggestion.type.slice(1)}\n                    </span>\n                  </button>\n                </li>\n              ))}\n            </ul>\n          </div>\n        )}\n      </form>\n\n      {/* Advanced Filters */}\n      {showFilters && (\n        <div className={`absolute z-10 mt-2 w-full bg-white rounded-lg shadow-lg border border-primary-200 ${isDismissing ? 'animate-fade-out' : 'animate-slide-down'}`}>\n          <div className=\"p-4\">\n            <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n              {/* Moods Section - Now with simple text list and color search link */}\n              <div className=\"lg:col-span-1 animate-fade-in\" style={{ animationDelay: '50ms' }}>\n                <h3 className=\"text-sm font-medium text-primary-900 mb-2\">Search by mood</h3>\n                <div className=\"flex flex-col gap-2 max-h-[250px] overflow-y-auto pr-1\">\n                  {moods.map((mood) => (\n                    <button\n                      key={mood}\n                      onClick={() => handleMoodSelect(mood)}\n                      className={`text-left text-sm p-2 rounded-lg transition-all duration-200 ${\n                        activeFilters.includes(mood)\n                          ? 'bg-primary-100 text-primary-700'\n                          : 'text-primary-700 hover:bg-primary-50'\n                      }`}\n                    >\n                      {mood}\n                    </button>\n                  ))}\n                </div>\n                \n                {/* Color Search Link */}\n                <div className=\"mt-4 pt-4 border-t border-primary-200\">\n                  <Link\n                    to=\"/color-search\"\n                    className=\"flex items-center justify-center w-full p-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-lg hover:from-purple-600 hover:to-pink-600 transition-all duration-200 transform hover:scale-105 shadow-lg\"\n                  >\n                    <span className=\"mr-2\">ðŸŽ¨</span>\n                    Try Color Search\n                    <svg className=\"w-4 h-4 ml-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 7l5 5m0 0l-5 5m5-5H6\" />\n                    </svg>\n                  </Link>\n                </div>\n              </div>\n              \n              {/* Themes Section */}\n              <div className=\"animate-fade-in\" style={{ animationDelay: '100ms' }}>\n                <h3 className=\"text-sm font-medium text-primary-900 mb-2\">Search by theme</h3>\n                <div className=\"flex flex-col gap-2 max-h-[300px] overflow-y-auto pr-1\">\n                  {themes.map((theme) => (\n                    <button\n                      key={theme}\n                      onClick={() => handleThemeSelect(theme)}\n                      className={`text-left text-sm p-2 rounded-lg transition-all duration-200 ${\n                        activeFilters.includes(theme)\n                          ? 'bg-primary-100 text-primary-700'\n                          : 'text-primary-700 hover:bg-primary-50'\n                      }`}\n                    >\n                      {theme}\n                    </button>\n                  ))}\n                </div>\n              </div>\n              \n              {/* Combined Reading Style and Professions Section */}\n              <div className=\"animate-fade-in\" style={{ animationDelay: '150ms' }}>\n                {/* Reading Style Section */}\n                <div className=\"mb-6\">\n                  <h3 className=\"text-sm font-medium text-primary-900 mb-2\">Search by reading style</h3>\n                  <div className=\"flex flex-col gap-2\">\n                    {readingStyles.map((style) => (\n                      <button\n                        key={style.id}\n                        onClick={() => handleReadingStyleSelect(style.id)}\n                        className={`text-left text-sm p-2 rounded-lg transition-all duration-200 ${\n                          activeFilters.includes(style.id)\n                            ? 'bg-primary-100 text-primary-700'\n                            : 'text-primary-700 hover:bg-primary-50'\n                        }`}\n                      >\n                        {style.label}\n                      </button>\n                    ))}\n                  </div>\n                </div>\n\n                {/* Professions Section */}\n                <div>\n                  <h3 className=\"text-sm font-medium text-primary-900 mb-2\">Search by profession</h3>\n                  <div className=\"flex flex-col gap-2 max-h-[200px] overflow-y-auto pr-1\">\n                    {professions.map((profession) => (\n                      <button\n                        key={profession.id}\n                        onClick={() => handleProfessionSelect(profession.id, profession.label)}\n                        className={`text-left text-sm p-2 rounded-lg transition-all duration-200 ${\n                          activeFilters.includes(profession.label)\n                            ? 'bg-primary-100 text-primary-700'\n                            : 'text-primary-700 hover:bg-primary-50'\n                        }`}\n                      >\n                        {profession.label}\n                      </button>\n                    ))}\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}